install.packages("tableone")
library(tableone)
table1(ca_transportation_region_race)
tableone(ca_transportation_region_race)
head(ca_transportation_region_race)
totals <- ca_transportation_region_race %>%
select(starts_with("total"))
View(totals)
totals <- ca_transportation_region_race %>%
select(contains("total"))
View(totals)
?tbl_summary()
ca_transportation_region_race <- ca_transportation %>%
filter(reportyear == "2006-2010",
geotype == "RE") %>%
select(5,11,13,15:17, 23) %>%
mutate(name = paste(race_eth_name, mode, sep="_")) %>%
select(8, 2, 4:7 )
View(ca_transportation_region_race)
ca_transportation_region_race <- ca_transportation %>%
filter(reportyear == "2006-2010",
geotype == "RE") %>%
select(5,11,13,15:17, 23) %>%
mutate(name = paste(race_eth_name, mode, sep="_")) %>%
select(8, 2, 4:7 ) %>%
pivot_wider(id_cols = region_name, names_from = name, values_from = c(percent, CA_RR))
ca_transportation_descriptive <- ca_transportation %>%
filter(reportyear == "2006-2010",
geotype == "RE") %>%
select(5,11,13,15:17, 23) %>%
mutate(name = paste(race_eth_name, mode, sep="_")) %>%
select(8, 2, 4:7 )
library(gtsummary)
table_one <- tbl_summary(data = ca_transportation_descriptive,
by = region_name,
missing = "no",
label = list(name ~ "Race Mode",
pop_mode ~ "Population Mode",
pop_total ~ "Population Total",
percent ~ "Percent",
CA_RR ~ "CA Risk Ratio"))
# Print Table 1 summary
print(my_table)
transportation_table_one <- tbl_summary(data = ca_transportation_descriptive,
by = region_name,
missing = "no",
label = list(name ~ "Race Mode",
pop_mode ~ "Population Mode",
pop_total ~ "Population Total",
percent ~ "Percent",
CA_RR ~ "CA Risk Ratio"))
# Print Table 1 summary
print(transportation_table_one)
View(transportation_table_one)
library(tableone)
transportation_table_one <- CreateTableOne(vars = c("name", "pop_mode", "pop_total", "percent", "CA_RR"),
strata = c("region_name"),
data = ca_transportation_descriptive)
View(transportation_table_one)
# Print Table 1 summary
print(transportation_table_one)
library(tableone)
transportation_table_one <- CreateTableOne(vars = c("name", "CA_RR"),
strata = c("region_name"),
data = ca_transportation_descriptive)
# Print Table 1 summary
print(transportation_table_one)
transportation_table_one <- CreateTableOne(vars = c("region_name", "CA_RR"),
strata = c("name"),
data = ca_transportation_descriptive)
# Print Table 1 summary
print(transportation_table_one)
#arranging data for table 1
ca_transportation_descriptive <- ca_transportation %>%
filter(reportyear == "2006-2010",
geotype == "RE") %>%
select(5,11,13,15:17, 23) %>%
mutate(name = paste(race_eth_name, mode, sep="_")) %>%
select(8, 2, 4:7 )
library(tableone)
transportation_table_one <- CreateTableOne(vars = c("region_name", "CA_RR"),
strata = c("name"),
data = ca_transportation_descriptive)
# Print Table 1 summary
print(transportation_table_one)
#arranging data for table 1
ca_transportation_descriptive <- ca_transportation %>%
filter(reportyear == "2006-2010",
geotype == "RE") %>%
select(5,11,13,15:17, 23) %>%
mutate(name = paste(race_eth_name, mode, sep="_")) %>%
select(8, 2, 4:7 )
library(tableone)
transportation_table_one <- CreateTableOne(vars = c("region_name", "CA_RR"),
strata = c("name"),
data = ca_transportation_descriptive)
# Print Table 1 summary
print(transportation_table_one)
library(gtsummary)
summary_table <- tbl_summary(data = ca_transportation_descriptive,
by = region,
missing = "no",
label = list(CA_RR ~ "Risk ratio for California residents against that region or county",
Total_ATHOME ~ "Total stayed at home",
Total_BICYCLE ~ "Total using bicycle",
Total_CAR ~ "Total using car",
Total_CARPOOL ~ "Total carpooling",
Total_CARTOTAL ~ "Total using car (including carpooling)",
Total_PUBLICTR ~ "Total using public transit",
Total_WALK ~ "Total walking"))
library(gtsummary)
summary_table <- tbl_summary(data = ca_transportation_descriptive,
by = region_name,
missing = "no",
label = list(CA_RR ~ "Risk ratio for California residents against that region or county",
Total_ATHOME ~ "Total stayed at home",
Total_BICYCLE ~ "Total using bicycle",
Total_CAR ~ "Total using car",
Total_CARPOOL ~ "Total carpooling",
Total_CARTOTAL ~ "Total using car (including carpooling)",
Total_PUBLICTR ~ "Total using public transit",
Total_WALK ~ "Total walking"))
library(gtsummary)
summary_table <- tbl_summary(data = ca_transportation_descriptive,
by = region_name,
missing = "no",
label = list(CA_RR ~ "Risk ratio for California residents against that region or county",
Total_ATHOME ~ "Total stayed at home"
summary_table <- tbl_summary(data = ca_transportation_descriptive,
summary_table <- tbl_summary(data = ca_transportation_descriptive,
by = region_name,
missing = "no",
label = list(CA_RR ~ "Risk ratio for California residents against that region or county",
Total_ATHOME ~ "Total stayed at home"
summary_table <- tbl_summary(data = ca_transportation_descriptive,
summary_table <- tbl_summary(data = ca_transportation_descriptive,
by = region_name,
missing = "no",
label = list(CA_RR ~ "Risk ratio for California residents against that region or county",
Total_ATHOME ~ "Total stayed at home",
Total_BICYCLE ~ "Total using bicycle",
Total_CAR ~ "Total using car"
summary_table <- tbl_summary(data = ca_transportation_descriptive,
summary_table <- tbl_summary(data = ca_transportation_descriptive,
by = region_name,
missing = "no",
label = list(CA_RR ~ "Risk ratio for California residents against that region or county",
Total_ATHOME ~ "Total stayed at home",
Total_BICYCLE ~ "Total using bicycle",
Total_CAR ~ "Total using car",
Total_CARPOOL ~ "Total carpooling",
Total_CARTOTAL ~ "Total using car (including carpooling)"
summary_table <- tbl_summary(data = ca_transportation_descriptive,
summary_table <- tbl_summary(data = ca_transportation_descriptive,
by = region_name,
missing = "no",
label = list(CA_RR ~ "Risk ratio for California residents against that region or county",
Total_ATHOME ~ "Total stayed at home",
Total_BICYCLE ~ "Total using bicycle",
Total_CAR ~ "Total using car",
Total_CARPOOL ~ "Total carpooling",
Total_CARTOTAL ~ "Total using car (including carpooling)",
Total_PUBLICTR ~ "Total using public transit",
Total_WALK ~ "Total walking"
summary_table <- tbl_summary(data = ca_transportation_descriptive,
summary_table <- tbl_summary(data = ca_transportation_descriptive,
by = region_name,
missing = "no",
label = list(CA_RR ~ "Risk ratio for California residents against that region or county",
Total_ATHOME ~ "Total stayed at home",
Total_BICYCLE ~ "Total using bicycle",
Total_CAR ~ "Total using car",
Total_CARPOOL ~ "Total carpooling",
Total_CARTOTAL ~ "Total using car (including carpooling)",
Total_PUBLICTR ~ "Total using public transit",
Total_WALK ~ "Total walking"))
library(tableone)
summary_table <- CreateTableOne(vars = c("CA_RR", "Total_ATHOME", "Total_BICYCLE", "Total_CAR",
"Total_CARPOOL", "Total_CARTOTAL", "Total_PUBLICTR", "Total_WALK"),
strata = "region_name",
data = ca_transportation_descriptive)
ca_transportation_descriptive <- ca_transportation %>%
filter(reportyear == "2006-2010",
geotype == "RE") %>%
select(5,11,13,15:17, 23) %>%
mutate(name = paste(race_eth_name, mode, sep="_")) %>%
select(8, 2, 4:7 )
View(ca_transportation_descriptive)
library(tableone)
summary_table <- CreateTableOne(vars = c("CA_RR", "Total_ATHOME", "Total_BICYCLE", "Total_CAR",
"Total_CARPOOL", "Total_CARTOTAL", "Total_PUBLICTR", "Total_WALK"),
strata = "region_name",
data = ca_transportation_region_race)
install.packages("table1")
ca_transportation_descriptive <- ca_transportation %>%
filter(reportyear == "2006-2010",
geotype == "RE") %>%
select(5,11,13,15:17, 23) %>%
mutate(name = paste(race_eth_name, mode, sep="_")) %>%
select(8, 2, 4:7 )
View(ca_transportation_descriptive)
#filter for certain observations
filtered_data <- ca_transportation_descriptive[ca_transportation_descriptive$name %in% c("Total_ATHOME", "Total_BICYCLE", "Total_CAR", "Total_CARPOOL", "Total_CARTOTAL", "Total_PUBLICTR", "Total_WALK")]
#filter for certain observations
filtered_data <- ca_transportation_descriptive %>%
filter(name %in% c("Total_ATHOME", "Total_BICYCLE", "Total_CAR", "Total_CARPOOL", "Total_CARTOTAL", "Total_PUBLICTR", "Total_WALK"))
# Create Table 1 summary
library(table1)
descriptive_table1 <- table1(~ region_name + name + pop_total + pop_mode + percent + CA_RR, data = filtered_data)
# Print summary table
print(descriptive_table1)
descriptive_table1 <- table1(region_name + name + pop_total + pop_mode + percent + CA_RR, data = filtered_data)
View(filtered_data)
descriptive_table1 <- table1(~name + region_name + name + pop_total + pop_mode + percent + CA_RR, data = filtered_data)
# Print summary table
print(descriptive_table1)
# Create Table 1 summary
library(table1)
descriptive_table1 <- table1(~ region_name | name + pop_total + pop_mode, data = filtered_data)
descriptive_table1 <- table1(~ name + pop_total + pop_mode | region_name, data = filtered_data)
# Print summary table
print(descriptive_table1)
# Create Table 1 summary
library(table1)
descriptive_table1 <- table1(~ name + region_name | CA_RR, data = filtered_data)
# Print summary table
print(descriptive_table1)
# Create Table 1 summary
library(table1)
descriptive_table1 <- table1(~ name + region_name | percent, data = filtered_data)
# Print summary table
print(descriptive_table1)
descriptive_table1 <- table1(~ region_name + percent | name, data = filtered_data)
# Print summary table
print(descriptive_table1)
descriptive_table1 <- table1(~ name + percent | region_name, data = filtered_data)
# Print summary table
print(descriptive_table1)
descriptive_table1 <- table1(~ region_name | name, data = filtered_data)
# Print summary table
print(descriptive_table1)
filter(region_name %in% c("Bay Area", "Butte", "Monterey Bay")
#filter for certain observations
filtered_data <- ca_transportation_descriptive %>%
filtered_data <- ca_transportation_descriptive %>%
filter(name %in% c("Total_ATHOME", "Total_BICYCLE", "Total_CAR", "Total_CARPOOL", "Total_CARTOTAL", "Total_PUBLICTR", "Total_WALK")) %>%
filter(region_name %in% c("Bay Area", "Butte", "Monterey Bay"))
View(filtered_data)
table_test <- table1(~ region_name + name + pop_mode + pop_total + percent + CA_RR | region_name,
data = filtered_data,
overall = FALSE)
print(table_test)
table_test <- table1(~ name + region_name + pop_mode + pop_total + percent + CA_RR | name,
data = filtered_data,
overall = FALSE)
print(table_test)
table_test <- table1(~ region_name + name + pop_mode + pop_total + percent + CA_RR | name,
data = filtered_data,
overall = FALSE)
print(table_test)
table_test <- table1(~ region_name + pop_mode + pop_total + percent | region_name,
data = filtered_data,
overall = FALSE)
print(table_test)
table_test <- table1(~ name + pop_mode + pop_total + percent | region_name,
data = filtered_data,
overall = FALSE)
print(table_test)
wide_data <- pivot_wider(
data = filtered_data,
id_cols = c(region_name, pop_mode, pop_total, percent, CA_RR),
names_from = name,
values_from = transportation_type # replace 'value_column' with the actual name of the column containing the values
)
wide_data <- pivot_wider(
data = ca_transportation_descriptive,
id_cols = c(region_name, pop_total, pop_mode, percent, CA_RR),
names_from = name,
values_from = c(region_name, pop_total, pop_mode, percent, CA_RR)
)
wide_data <- pivot_wider(
data = ca_transportation_descriptive,
id_cols = c(region_name, pop_total, pop_mode, percent, CA_RR),
names_from = name,
values_from = c(pop_total, pop_mode, percent, CA_RR)
)
wide_data <- pivot_wider(
data = ca_transportation_descriptive,
id_cols = c(region_name),
names_from = name,
values_from = c(pop_total, pop_mode, percent, CA_RR)
)
View(wide_data)
wide_data <- pivot_wider(
data = filtered_data,
id_cols = c(region_name),
names_from = name,
values_from = c(pop_total, pop_mode, percent, CA_RR)
)
summary_table <- table1(~ region_name + Total_ATHOME + Total_BICYCLE + Total_CAR + Total_CARPOOL + Total_CARTOTAL + Total_PUBLICTR + Total_WALK + pop_mode_Total_ATHOME + pop_mode_Total_BICYCLE + pop_mode_Total_CAR + pop_mode_Total_CARPOOL + pop_mode_Total_CARTOTAL + pop_mode_Total_PUBLICTR + pop_mode_Total_WALK + percent_Total_ATHOME + percent_Total_BICYCLE + percent_Total_CAR + percent_Total_CARPOOL + percent_Total_CARTOTAL + percent_Total_PUBLICTR + percent_Total_WALK + CA_RR_Total_ATHOME + CA_RR_Total_BICYCLE + CA_RR_Total_CAR + CA_RR_Total_CARPOOL + CA_RR_Total_CARTOTAL + CA_RR_Total_PUBLICTR + CA_RR_Total_WALK | region_name,
data = wide_data,
overall = FALSE
)
summary_table <- table1(~ region_name + pop_mode_Total_ATHOME + pop_mode_Total_BICYCLE + pop_mode_Total_CAR + pop_mode_Total_CARPOOL + pop_mode_Total_CARTOTAL + pop_mode_Total_PUBLICTR + pop_mode_Total_WALK + percent_Total_ATHOME + percent_Total_BICYCLE + percent_Total_CAR + percent_Total_CARPOOL + percent_Total_CARTOTAL + percent_Total_PUBLICTR + percent_Total_WALK + CA_RR_Total_ATHOME + CA_RR_Total_BICYCLE + CA_RR_Total_CAR + CA_RR_Total_CARPOOL + CA_RR_Total_CARTOTAL + CA_RR_Total_PUBLICTR + CA_RR_Total_WALK | region_name,
data = wide_data,
overall = FALSE
)
# Print summary table
print(summary_table)
View(ca_transportation_mode_race)
View(ca_transportation_mode_race)
View(ca_transportation_region_race)
ca_transportation_descriptive <- ca_transportation %>%
filter(reportyear == "2006-2010",
geotype == "RE") %>%
select(5,11,13,15:17, 23) %>%
mutate(name = paste(race_eth_name, mode, sep="_")) %>%
select(8, 2, 4:7 ) %>%
filter(region_name %in% c("Bay Area", "Butte", "Monterey Bay"))
View(ca_transportation_descriptive)
ca_transportation_descriptive <- ca_transportation %>%
filter(reportyear == "2006-2010",
geotype == "RE") %>%
select(5,11,13,15:17, 23) %>%
mutate(name = paste(race_eth_name, mode, sep="_")) %>%
select(8, 2, 4:7 ) %>%
filter(region_name %in% c("Bay Area", "Butte", "Monterey Bay")) %>%
select(1, 2, 5, 6)
table_test <- table1(~ region_name + percent + CA_RR | name,
data = ca_transportation_descriptive,
overall = FALSE)
print(table_test)
table_test <- table1(~ region_name + name + percent + CA_RR | region_name,
data = ca_transportation_descriptive,
overall = FALSE)
print(table_test)
table_test <- table1(~ name + percent + CA_RR | region_name,
data = ca_transportation_descriptive,
overall = FALSE)
print(table_test)
table_test <- table1(~ region_name + percent + CA_RR | name,
data = ca_transportation_descriptive,
overall = FALSE)
print(table_test)
library(table1)
table_test <- table1(~ region_name + percent + CA_RR | name,
data = ca_transportation_descriptive,
overall = FALSE)
print(table_test)
ca_transportation_descriptive <- ca_transportation %>%
filter(reportyear == "2006-2010",
geotype == "RE") %>%
select(5,11,13,15:17, 23) %>%
mutate(race_mode_transport = paste(race_eth_name, mode, sep="_")) %>%
select(8, 2, 4:7 ) %>%
filter(region_name %in% c("Bay Area", "Butte", "Monterey Bay")) %>%
select(1, 2, 5, 6)
library(table1)
table_one_test <- table1(~ region_name + percent + CA_RR | race_mode_transport,
data = ca_transportation_descriptive,
overall = FALSE)
print(table_one_test)
ca_transportation_region_race <- ca_transportation %>%
filter(reportyear == "2006-2010",
geotype == "RE") %>%
select(5,11,13,15:17, 23) %>%
mutate(race_mode_transport = paste(race_eth_name, mode, sep="_")) %>%
select(8, 2, 4:7 ) %>%
pivot_wider(id_cols = region_name, names_from = race_mode_transport, values_from = c(percent, CA_RR))
View(ca_transportation)
data_figure_one <- ca_transportation %>%
filter(reportyear == "2006-2010",
geotype == "RE")
View(data_figure_one)
data_figure_one <- ca_transportation %>%
filter(reportyear == "2006-2010",
geotype == "RE") %>%
select(5,11,13,15:17, 23)
data_figure_one <- ca_transportation %>%
filter(reportyear == "2006-2010",
geotype == "RE") %>%
select(5,11,13,15:17, 23) %>%
filter(region_name %in% c("Bay Area", "Butte", "Monterey Bay"))
library(ggplot2)
#creating plot
ggplot(data_figure_one, aes(x = mode, y = percent, fill = race_eth_name)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ region_name) +
labs(x = "Mode of Transportation", y = "Percent", fill = "Race/Ethnicity") +
theme_minimal()
ggplot(data_figure_one, aes(x = mode, y = percent, fill = race_eth_name)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ region_name) +
labs(x = "Mode of Transportation", y = "Percent", fill = "Race/Ethnicity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(pacman, rio, tidyverse)
library(tidyverse)
library(pacman, rio, tidyverse)
library(pacman)
library(pacman, rio)
library(pacman, rio, tidyverse)
library(readxl)
nat_outbreak_data <- read_excel("Desktop/GH 598/Data_vis/NationalOutbreakPublicDataTool.xlsx")
head(nat_outbreak_data)
View(nat_outbreak_data)
cleaned_nat_outbreak_data <- nat_outbreak_data %>%
filter(c(1:15))
cleaned_nat_outbreak_data <- nat_outbreak_data %>%
filter(1:15)
cleaned_nat_outbreak_data <- nat_outbreak_data %>%
select(1:15)
View(cleaned_nat_outbreak_data)
cleaned_nat_outbreak_data <- nat_outbreak_data %>%
select(1:5, 8:15)
cleaned_nat_outbreak_data <- nat_outbreak_data %>%
select(1:5, 8:15) %>%
filter(str_detect(`Food Vehicle`, "berries|berry|fruit") |
str_detect(`Food Contaminated Ingredient`, "berries|berry|fruit"))
cleaned_nat_outbreak_data <- nat_outbreak_data %>%
select(1:5, 8:15) %>%
filter(str_detect(`Food Vehicle`, "berries|berry|fruit") |
str_detect(`Food Contaminated Ingredient`, "berries|berry|fruit"))
cleaned_nat_outbreak_data <- nat_outbreak_data %>%
select(1:5, 8:15)
cleaned_nat_outbreak_data <- nat_outbreak_data %>%
select(1:5, 8:15) %>%
filter(str_detect(`Food Vehicle`, "berr") |
str_detect(`Food Contaminated Ingredient`, "berr"))
q2_outbreak_data <- cleaned_nat_outbreak_data %>%
group_by(Etiology)
View(q2_outbreak_data)
q2_outbreak_data <- cleaned_nat_outbreak_data %>%
group_by(Etiology) %>%
summarize(Count = n())
broad_q2_outbreak_data <- cleaned_nat_outbreak_data %>%
mutate(Virus_Group = if_else(Etiology == "Hepatitis A", "Hepatitis A", "Norovirus")) %>%
group_by(Virus_Group) %>%
summarize(Count = n())
View(broad_q2_outbreak_data)
View(cleaned_nat_outbreak_data)
q3_by_state_outbreak <- cleaned_nat_outbreak_data %>%
group_by(State) %>%
summarize(Count = n())
View(q3_by_state_outbreak)
q3_by_state_outbreak <- cleaned_nat_outbreak_data %>%
group_by(State) %>%
summarize(Count = n()) %>%
add_row(State = "Total", Count = sum(Count))
q3_by_state_outbreak <- cleaned_nat_outbreak_data %>%
group_by(State) %>%
summarize(Count = n())
q3_by_state_outbreak <- cleaned_nat_outbreak_data %>%
group_by(State) %>%
summarize(Count = n()) %>%
add_row(State = "Total", Count = sum(Count))
```{r q3}
q3_by_state_outbreak <- cleaned_nat_outbreak_data %>%
group_by(State) %>%
summarize(Count = n()) %>%
add_row(State = "Total", Count = sum(.$Count))
library(ggplot2)
# United States map data
us_map <- map_data("state")
# Merge state data with outbreak count data
map_data <- merge(us_map, state_breakdown, by.x = "region", by.y = "State", all.x = TRUE)
# Merge state data with outbreak count data
map_data <- merge(us_map, q3_by_state_outbreak, by.x = "region", by.y = "State", all.x = TRUE)
# Create the map
ggplot(map_data, aes(x = long, y = lat, group = group, fill = Count)) +
geom_polygon(color = "white") +
scale_fill_gradient(name = "Outbreak Count", low = "lightblue", high = "darkblue", na.value = "grey", guide = "legend") +
labs(title = "Viral Berry Outbreaks by State") +
theme_minimal() +
theme(legend.position = "right")
ggplot(map_data, aes(x = long, y = lat, group = group, fill = Count)) +
geom_polygon(color = "white")
ggplot(map_data, aes(x = long, y = lat, group = group, fill = Count)) +
geom_polygon(color = "white") +
scale_fill_gradient(name = "Outbreak Count", low = "lightblue", high = "darkblue", na.value = "grey", guide = "legend")
ggplot(map_data, aes(x = long, y = lat, group = group, fill = Count)) +
geom_polygon(color = "white") +
scale_fill_gradient(name = "Outbreak Count", low = "lightblue", high = "darkblue", na.value = "grey", guide = "legend") +
labs(title = "Viral Berry Outbreaks by State")
# Merge state data with outbreak count data
map_data <- merge(us_map, q3_by_state_outbreak, by.x = "region", by.y = "State", all.x = TRUE)
# Create the map
ggplot(map_data, aes(x = long, y = lat, group = group, fill = Count)) +
geom_polygon(color = "white") +
scale_fill_gradient(name = "Outbreak Count", low = "lightblue", high = "darkblue", na.value = "grey", guide = "legend") +
labs(title = "Viral Berry Outbreaks by State") +
theme_minimal() +
theme(legend.position = "right")
ggplot(map_data, aes(x = long, y = lat, group = group, fill = Count)) +
geom_polygon(color = "white") +
scale_fill_gradient(name = "Outbreak Count", low = "lightblue", high = "darkblue", na.value = "grey", guide = "legend")
View(map_data)
# Merge state data with outbreak count data
map_data$region <- tolower(map_data$region)
map_data <- merge(us_map, q3_by_state_outbreak, by.x = "region", by.y = "State", all.x = TRUE)
View(map_data)
# Merge state data with outbreak count data
q3_by_state_outbreak$state <- tolower(q3_by_state_outbreak$State)
map_data <- merge(us_map, q3_by_state_outbreak, by.x = "region", by.y = "State", all.x = TRUE)
getwd()
setwd("~/Desktop/Data_550/Final")
getwd()
install.packages("renv")
renv::init()
renv::status()
.libPaths()
getwd()
